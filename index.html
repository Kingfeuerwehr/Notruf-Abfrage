<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notrufabfrage • AAO • Voll</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .btn{border-radius:1rem;padding:.5rem .75rem;box-shadow:0 1px 2px rgba(0,0,0,.07)}
    .badge{display:inline-block;border-radius:9999px;padding:.125rem .5rem;font-size:.75rem;border:1px solid #e5e7eb}
    .qty{display:inline-flex;align-items:center;gap:.4rem;border:1px solid #e5e7eb;border-radius:9999px;padding:.2rem .55rem;background:#fff}
    .qty button{width:1.6rem;height:1.6rem;border-radius:9999px;border:1px solid #e5e7eb;line-height:1.6rem;text-align:center}
  </style>
</head>
<body class="bg-slate-50 min-h-screen">
  <!-- Festes Logo oben rechts -->
  <div class="fixed top-3 right-3 z-50 pointer-events-none select-none">
    <img src="assets/ILS_Logo.png" alt="Logo" class="h-16 w-auto drop-shadow" loading="eager" decoding="async" />
  </div>

  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    /* ========= AAO & Stichworte =========
       Hinweis: Passe diese Tabellen 1:1 auf eure AAO an.           */

    // Haupt-Stichworte (Feuerwehr, BMA, TH, ABC, THW, RD, MANV)
    const AAO = [
      /* ===== Feuerwehr: Brand ===== */
      { Stichwort: "B - 1", Fahrzeuge_AAO: "(H)LF oder TLF", Info: "Brand klein" },
      { Stichwort: "B - 2", Fahrzeuge_AAO: "ELW 1, 2x (H)LF, DLK, TLF & RTW", Info: "Brand mittel" },
      { Stichwort: "B - 3", Fahrzeuge_AAO: "ELW 1, 3x (H)LF, DLK, 2x TLF & RTW", Info: "Brand groß" },
      { Stichwort: "B - 4", Fahrzeuge_AAO: "ELW 2, 4x (H)LF, DLK, 3x TLF, 2x RTW", Info: "Brand sehr groß" },
      { Stichwort: "B - 2Y", Fahrzeuge_AAO: "ELW 1, 2x (H)LF, DLK, TLF & NEF, 2x RTW", Info: "Brand mittel, P in Gefahr" },
      { Stichwort: "B - 3Y", Fahrzeuge_AAO: "ELW 1, 3x (H)LF, DLK, 2x TLF & NEF, 3x RTW", Info: "Brand groß, 2 P in Gefahr" },
      { Stichwort: "B - 4Y", Fahrzeuge_AAO: "ELW 2, 4x (H)LF, DLK, 3x TLF & 2x NEF, 4x RTW", Info: "Brand sehr groß, 3+ P" },

      /* ===== Feuerwehr: BMA/CO/RWM ===== */
      { Stichwort: "BMA", Fahrzeuge_AAO: "ELW 1, (H)LF, DLK (bei Bedarf)", Info: "Brandmeldeanlage ausgelöst" },
      { Stichwort: "BMA - Industrie", Fahrzeuge_AAO: "ELW 1, 2x (H)LF, DLK, TLF", Info: "BMA Industrie" },
      { Stichwort: "Heimrauchmelder", Fahrzeuge_AAO: "(H)LF, DLK (örtlich)", Info: "Ausgelöster Heimrauchmelder" },
      { Stichwort: "CO-Melder", Fahrzeuge_AAO: "(H)LF, GW-Mess / Messen 1", Info: "CO-Alarm/Warner" },

      /* ===== Technische Hilfe ===== */
      { Stichwort: "TH - 1", Fahrzeuge_AAO: "HLF", Info: "TH klein" },
      { Stichwort: "TH - 2", Fahrzeuge_AAO: "HLF, RW", Info: "TH mittel" },
      { Stichwort: "TH - 3", Fahrzeuge_AAO: "ELW 1, 2x HLF, RW, TLF", Info: "TH groß" },
      { Stichwort: "TH - VU", Fahrzeuge_AAO: "HLF, RW, RTW", Info: "Verkehrsunfall" },
      { Stichwort: "TH - P-klemmt", Fahrzeuge_AAO: "ELW 1, HLF, RW, TLF & NEF, 2x RTW", Info: "VU P eingeklemmt" },
      { Stichwort: "TH - Wasser", Fahrzeuge_AAO: "HLF, Boot, GW-W", Info: "Wasserrettung/-schaden" },
      { Stichwort: "TH - Höhen/Tiefen", Fahrzeuge_AAO: "HLF, RW, Höhenretter", Info: "SRHT" },
      { Stichwort: "TH - Gas 1", Fahrzeuge_AAO: "HLF", Info: "Gasgeruch" },
      { Stichwort: "TH - Gas 2", Fahrzeuge_AAO: "HLF, GW-G/AB-G", Info: "Gasleitung beschädigt" },

      /* ===== ABC / Gefahrgut ===== */
      { Stichwort: "ABC - 1", Fahrzeuge_AAO: "HLF, GW-G", Info: "Gefahrstoff klein" },
      { Stichwort: "ABC - 2", Fahrzeuge_AAO: "ELW 1, HLF, GW-G/AB-G, RTW", Info: "Gefahrstoff mittel" },
      { Stichwort: "ABC - 3", Fahrzeuge_AAO: "ELW 2, 2x HLF, GW-G/AB-G, Dekon-P, Messen 2, RTW", Info: "Gefahrstoff groß" },
      { Stichwort: "Messen 1", Fahrzeuge_AAO: "GW-Mess / KdoW (Messung)", Info: "Messtrupp klein" },
      { Stichwort: "Messen 2", Fahrzeuge_AAO: "GW-Mess, ELW 1", Info: "Messtrupp erweitert" },
      { Stichwort: "Dekon-P", Fahrzeuge_AAO: "Dekon-P, HLF", Info: "Dekontamination Personen" },

      /* ===== THW (typische Anforderungen) ===== */
      { Stichwort: "THW - Beleuchtung", Fahrzeuge_AAO: "THW: MzKW/GKW, Anh. Licht", Info: "Einsatzbeleuchtung" },
      { Stichwort: "THW - Pumpen", Fahrzeuge_AAO: "THW: MzKW/GKW, Hochwasserpumpe", Info: "Wasser fördern" },
      { Stichwort: "THW - Räumen", Fahrzeuge_AAO: "THW: Radlader/Bagger, MzKW", Info: "Räumen/Abstützen" },
      { Stichwort: "THW - Eigensicherung", Fahrzeuge_AAO: "THW: GKW, EGS", Info: "Eigentumssicherung" },
      { Stichwort: "THW - Logistik", Fahrzeuge_AAO: "THW: LKW K9, MTW OV", Info: "Logistik/Material" },
      { Stichwort: "THW - Brücke", Fahrzeuge_AAO: "THW: Brückenbau-Trupp", Info: "Behelfsbrücke" },
      { Stichwort: "THW - Fachberater", Fahrzeuge_AAO: "THW: FB OV", Info: "Fachberater THW" },

      /* ===== Rettungsdienst ===== */
      { Stichwort: "Krankentransport", Fahrzeuge_AAO: "NKTW oder RTW", Info: "Transport ohne Eile" },
      { Stichwort: "Notfall 1", Fahrzeuge_AAO: "RTW oder NKTW", Info: "Allgemeiner Notfall" },
      { Stichwort: "Hilflose Person", Fahrzeuge_AAO: "RTW oder NKTW", Info: "Tür öffnen/Hilfe Person" },
      { Stichwort: "Trauma", Fahrzeuge_AAO: "RTW", Info: "Trauma ohne Polytrauma" },
      { Stichwort: "Notfall 2", Fahrzeuge_AAO: "RTW", Info: "kritischer Notfall" },
      { Stichwort: "Reanimation", Fahrzeuge_AAO: "RTW, NEF (ggf.), AED", Info: "CPR/Herzstillstand" },
      { Stichwort: "Polytrauma", Fahrzeuge_AAO: "RTH & NEF & RTW", Info: "Schwerstverletzte" },

      /* ===== MANV/Sonderlage ===== */
      { Stichwort: "MANV-1", Fahrzeuge_AAO: "3x RTW, 2x NEF, 1x NKTW, LF KatS, LNA, San-Zug", Info: "5–9 Verletzte" },
      { Stichwort: "MANV-2", Fahrzeuge_AAO: "+ ORGL, ELRD, Betreuungszug", Info: "10–19 Verletzte" },
      { Stichwort: "MANV-3", Fahrzeuge_AAO: "+ ÄLRD, Versorgungszug", Info: "20–29 Verletzte" },
      { Stichwort: "RDAZ-1", Fahrzeuge_AAO: "2x RTW/NKTW & 1x NEF", Info: "RD-Ausnahmezustand 1" },
      { Stichwort: "AL/TL", Fahrzeuge_AAO: "2x RTW, 1x NEF, LF KatS, LNA, ORGL, San-/Betreuungs-/Führungszug", Info: "Amok/Terror" },
    ];
    const byKey = (k) => AAO.find(e => e.Stichwort.toLowerCase() === (k||'').toLowerCase()) || null;

    /* ========= Brand-Zusatz je Größe ========= */
    const BRAND_SUBS = {
      klein:  ["PKW", "Container", "Kamin", "Garage", "Mülltonne", "Hecke"],
      mittel: ["Wohnung", "Dachstuhl", "Keller", "LKW", "Scheune"],
      gross:  ["Industrie", "Landwirtschaft", "Halle", "Hochhaus"]
    };

    /* ========= AAO-Erhöhung (mit Mengen, gruppiert) ========= */
    const AAO_ERHOEHUNG_GROUPS = [
      {
        title: "Lösch-/Rüstfahrzeuge",
        items: [
          { key: "(H)LF", label: "(H)LF" },
          { key: "TLF",  label: "TLF"  },
          { key: "RW",   label: "RW"   },
          { key: "DLK",  label: "DLK"  },
        ]
      },
      {
        title: "Führung BF/FF",
        items: [
          { key: "ELW 1", label: "ELW 1" },
          { key: "ELW 2", label: "ELW 2" },
          { key: "KdoW A-Dienst", label: "KdoW A-Dienst" },
          { key: "KdoW B-Dienst", label: "KdoW B-Dienst" },
          { key: "KdoW C-Dienst", label: "KdoW C-Dienst" },
          { key: "UG-ÖEL", label: "UG-ÖEL" },
        ]
      },
      {
        title: "Rettungsdienst & Führung RD",
        items: [
          { key: "RTW",  label: "RTW"  },
          { key: "NEF",  label: "NEF"  },
          { key: "NKTW", label: "NKTW" },
          { key: "ORGL", label: "ORGL (OrgL RD)" },
          { key: "LNA",  label: "LNA (Leitender Notarzt)" },
          { key: "ELRD", label: "ELRD" },
          { key: "ÄLRD", label: "ÄLRD" },
          { key: "UG-Rett", label: "UG-Rett" },
        ]
      },
      {
        title: "Wasser / Gefahrgut / Messen / Dekon",
        items: [
          { key: "GW-G", label: "GW-G" },
          { key: "GW-W", label: "GW-W" },
          { key: "GW-Mess", label: "GW-Mess" },
          { key: "Dekon-P", label: "Dekon-P" },
        ]
      },
      {
        title: "THW",
        items: [
          { key: "THW GKW/MzKW", label: "THW GKW/MzKW" },
          { key: "THW Anh. Licht", label: "THW Anh. Licht" },
          { key: "THW Hochwasserpumpe", label: "THW Hochwasserpumpe" },
          { key: "THW Räumen (Bagger/Radlader)", label: "THW Räumen" },
          { key: "THW Logistik (LKW/MTW OV)", label: "THW Logistik" },
          { key: "THW Brückenbau", label: "THW Brückenbau" },
          { key: "THW Fachberater", label: "THW Fachberater" },
        ]
      }
    ];

    /* ========= Listen ========= */
    const RD_SUBS = ["Krankentransport","Notfall 1","Hilflose Person","Trauma","Notfall 2","Reanimation","Polytrauma"];
    const TH_LIST  = AAO.filter(e => e.Stichwort.startsWith("TH - ")).map(e => e.Stichwort);
    const ABC_LIST = AAO.filter(e => e.Stichwort.startsWith("ABC")).map(e => e.Stichwort).concat(["Messen 1","Messen 2","Dekon-P"]);
    const BMA_LIST = ["BMA","BMA - Industrie","Heimrauchmelder","CO-Melder"];
    const THW_LIST = AAO.filter(e => e.Stichwort.startsWith("THW - ")).map(e => e.Stichwort);

    /* ========= Utils ========= */
    const num = (v)=> typeof v === "number" ? v : (v === "" ? 0 : Number(v));
    function brandCodeAndText(fireSize, persons){
      const p = num(persons);
      if (p >= 3) return { code: "B4Y", text: "" };
      if (p === 2) return { code: "B3Y", text: "" };
      if (p === 1) return { code: "B2Y", text: "" };
      if (fireSize === "mittel") return { code: "B2", text: "Mittel" };
      if (fireSize === "gross")  return { code: "B3", text: "Groß" };
      return { code: "B1", text: "Klein" };
    }
    const niceExtra = (x)=>({
      PKW:"PKW-Brand", Container:"Containerbrand", Kamin:"Kaminbrand", Garage:"Garagenbrand",
      Mülltonne:"Mülltonnenbrand", Hecke:"Heckenbrand",
      Wohnung:"Wohnungsbrand", Dachstuhl:"Dachstuhlbrand", Keller:"Kellerbrand", LKW:"LKW-Brand",
      Industrie:"Industriebrand", Landwirtschaft:"Landwirtschaftsbrand", Halle:"Hallenbrand", Hochhaus:"Hochhausbrand"
    }[x] || x);

    function pickAAO(a){
      // MANV/Sonderlage
      if (a.category === "MANV/Sonderlage") {
        const v = num(a.personsInDanger);
        if (/(amok|terror|schusswaffe|explosion)/i.test(a.details||"")) return byKey("AL/TL");
        if (v >= 20) return byKey("MANV-3");
        if (v >= 10) return byKey("MANV-2");
        if (v >= 5)  return byKey("MANV-1");
        return byKey("RDAZ-1");
      }
     
